CPU
 └── launch kernel
      └── Grid（二维）
           └── Block（16×16）
                └── Thread（1 个 C[row][col]）



Block
 ├── 所有 thread 加载 As / Bs
 ├── __syncthreads()
 ├── 所有 thread 使用 As / Bs
 ├── __syncthreads()
 ├── 下一轮 t


Grid
 ├── Block(0,0) → C[0..15][0..15]
 ├── Block(1,0) → C[0..15][16..31]
 ├── Block(0,1) → C[16..31][0..15]
 ├── ...



block 之间：
无通信
无同步
顺序不确定

一个 thread = 算一个 C 元素
一个 block = 协作算一个 tile
Grid = 覆盖整个矩阵
K 维度靠时间循环完成

┌──────────────────────────────┐
│ Thread 启动                  │
└──────────────┬───────────────┘
               │
               ▼
┌──────────────────────────────┐
│ 计算 row / col               │
│ row = blockIdx.y*16 + ty     │
│ col = blockIdx.x*16 + tx     │
└──────────────┬───────────────┘
               │
               ▼
┌──────────────────────────────┐
│ sum = 0                      │
│ (寄存器私有变量)             │
└──────────────┬───────────────┘
               │
               ▼
┌──────────────────────────────┐
│ for t = 0 .. ceil(K/16)-1    │◄───────────────┐
└──────────────┬───────────────┘                │
               │                                │
               ▼                                │
┌──────────────────────────────┐                │
│ 从 Global 读 A[row][t*16+tx] │                │
│ 写入 As[ty][tx]              │                │
└──────────────┬───────────────┘                │
               │                                │
               ▼                                │
┌──────────────────────────────┐                │
│ 从 Global 读 B[t*16+ty][col] │                │
│ 写入 Bs[ty][tx]              │                │
└──────────────┬───────────────┘                │
               │                                │
               ▼                                │
┌──────────────────────────────┐                │
│ __syncthreads()              │  ← block 内同步 │
│ 等待所有线程加载完成         │                │
└──────────────┬───────────────┘                │
               │                                │
               ▼                                │
┌──────────────────────────────┐                │
│ for k = 0..15                │                │
│   sum += As[ty][k]*Bs[k][tx] │                │
└──────────────┬───────────────┘                │
               │                                │
               ▼                                │
┌──────────────────────────────┐                │
│ __syncthreads()              │  ← 防止下一轮覆盖
└──────────────┬───────────────┘                │
               │                                │
               └──────── 回到 for(t) ───────────┘
               │
               ▼
┌──────────────────────────────┐
│ if (row<M && col<N)          │
│   C[row*N+col] = sum         │
└──────────────┬───────────────┘
               │
               ▼
┌──────────────────────────────┐
│ Thread 结束                  │
└──────────────────────────────┘
